{"version":3,"file":"js/436.9c9d0212.js","mappings":"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","sources":["webpack://book/./src/views/BookSearchView.vue","webpack://book/./src/views/BookSearchView.vue?d53f"],"sourcesContent":["<template>\n  <div class=\"home\" style =\"padding: 10px\">\n\n    <!-- 搜索-->\n    <div style=\"margin: 10px 0;\">\n      <el-form inline=\"true\" size=\"small\">\n        <el-form-item label=\"图书编号\" >\n          <el-input v-model=\"search1\" placeholder=\"请输入图书编号\"  clearable>\n            <template #prefix><el-icon class=\"el-input__icon\"><search/></el-icon></template>\n          </el-input>\n        </el-form-item >\n        <el-form-item label=\"图书名称\" >\n          <el-input v-model=\"search2\" placeholder=\"请输入图书名称\"  clearable>\n            <template #prefix><el-icon class=\"el-input__icon\"><search /></el-icon></template>\n          </el-input>\n        </el-form-item >\n        <el-form-item label=\"作者\" >\n          <el-input v-model=\"search3\" placeholder=\"请输入作者\"  clearable>\n            <template #prefix><el-icon class=\"el-input__icon\"><search /></el-icon></template>\n          </el-input>\n        </el-form-item >\n        <el-form-item>\n          <el-button type=\"primary\" style=\"margin-left: 1%\" @click=\"load\" size=\"mini\" >\n            <svg-icon iconClass=\"search\"/>查询</el-button>\n        </el-form-item>\n        <el-form-item>\n          <el-button size=\"mini\"  type=\"danger\" @click=\"clear\">重置</el-button>\n        </el-form-item>\n        <el-form-item style=\"float: right\" v-if=\"numOfOutDataBook!=0\">\n          <el-popconfirm\n              confirm-button-text=\"查看\"\n              cancel-button-text=\"取消\"\n              :icon=\"InfoFilled\"\n              icon-color=\"red\"\n              title=\"您有图书已逾期，请尽快归还\"\n              @confirm=\"toLook\"\n          >\n            <template #reference>\n              <el-button  type=\"warning\">逾期通知</el-button>\n            </template>\n          </el-popconfirm>\n        </el-form-item>\n      </el-form>\n    </div>\n    <!-- 按钮-->\n    <div style=\"margin: 10px 0;\" >\n      <!-- <el-button type=\"primary\" size=\"mini\" @click = \"add\" v-if=\"user.role === 1\" style=\"margin-right: 10px\">上架</el-button> -->\n      <el-popconfirm title=\"确认删除?\" @confirm=\"deleteBatch\" v-if=\"user.role === 1\">\n        <template #reference>\n          <el-button type=\"danger\" size=\"mini\" >批量删除</el-button>\n        </template>\n      </el-popconfirm>\n    </div>\n    <!-- 数据字段-->\n    <el-table :data=\"tableData\" stripe border=\"true\" @selection-change=\"handleSelectionChange\">\n      <el-table-column v-if=\"user.role === 1\"\n                       type=\"selection\"\n                       width=\"55\">\n      </el-table-column>\n      <el-table-column prop=\"id\" label=\"图书编号\" sortable />\n      <el-table-column prop=\"title\" label=\"书名\" />\n      <el-table-column prop=\"author\" label=\"作者\" />\n      <el-table-column prop=\"available_qty\" label=\"可借阅数量\" sortable />\n      <el-table-column fixed=\"right\" label=\"操作\" >\n        <template v-slot=\"scope\">\n          <el-button  size=\"mini\" @click =\"handleEdit(scope.row)\" v-if=\"user.role === 1\">修改</el-button>\n          <el-popconfirm title=\"确认删除?\" @confirm=\"handleDelete(scope.row.id)\" v-if=\"user.role === 1\">\n            <template #reference>\n              <el-button type=\"danger\" size=\"mini\" >删除</el-button>\n            </template>\n          </el-popconfirm>\n          <el-button  size=\"mini\" @click =\"handlelend(scope.row.id)\" v-if=\"user.role == 0\" :disabled=\"scope.row.hasBorrowed\">借阅</el-button>\n          <el-popconfirm title=\"确认还书?\" @confirm=\"handlereturn(scope.row.borrowId)\" v-if=\"user.role == 0\">\n            <template #reference>\n              <el-button type=\"danger\" size=\"mini\" :disabled=\"!scope.row.borrowId\" >还书</el-button>\n            </template>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n<!--测试,通知对话框-->\n    <el-dialog\n        v-model=\"dialogVisible3\"\n        v-if=\"numOfOutDataBook!=0\"\n        title=\"逾期详情\"\n        width=\"50%\"\n        :before-close=\"handleClose\"\n    >\n        <el-table :data=\"outDateBook\" style=\"width: 100%\">\n          <el-table-column prop=\"isbn\" label=\"图书编号\" />\n          <el-table-column prop=\"bookName\" label=\"书名\" />\n          <el-table-column prop=\"lendtime\" label=\"借阅日期\" />\n          <el-table-column prop=\"deadtime\" label=\"截至日期\" />\n        </el-table>\n\n      <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"dialogVisible3 = false\"\n        >确认</el-button>\n      </span>\n      </template>\n    </el-dialog>\n    <!--    分页-->\n    <div style=\"margin: 10px 0\">\n      <el-pagination\n          v-model:currentPage=\"currentPage\"\n          :page-size=\"pageSize\"\n          layout=\"total, prev, pager, next, jumper\"\n          :total=\"total\"\n          @current-change=\"handleCurrentChange\"\n      >\n      </el-pagination>\n\n      <el-dialog v-model=\"dialogVisible\" title=\"上架书籍\" width=\"30%\">\n        <el-form :model=\"form\" label-width=\"120px\">\n\n          <el-form-item label=\"书名\">\n            <el-input style=\"width: 80%\" v-model=\"form.title\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"作者\">\n            <el-input style=\"width: 80%\" v-model=\"form.author\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"可借阅数量\">\n            <el-input style=\"width: 80%\" v-model.number=\"form.available_qty\" type=\"number\" min=\"0\"></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"save\">确 定</el-button>\n      </span>\n        </template>\n      </el-dialog>\n\n      <el-dialog v-model=\"dialogVisible2\" title=\"修改书籍信息\" width=\"30%\">\n        <el-form :model=\"form\" label-width=\"120px\">\n\n          <el-form-item label=\"书名\">\n            <el-input style=\"width: 80%\" v-model=\"form.title\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"作者\">\n            <el-input style=\"width: 80%\" v-model=\"form.author\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"可借阅数量\">\n            <el-input style=\"width: 80%\" v-model.number=\"form.available_qty\" type=\"number\" min=\"0\"></el-input>\n          </el-form-item>\n        </el-form>\n        <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"save\">确 定</el-button>\n      </span>\n        </template>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport request from \"../utils/request\";\nimport {ElMessage} from \"element-plus\";\n\n// 本地模拟一些图书数据，方便在未接后端时调试前端\nconst mockBooks = [\n  {\n    id: 1,\n    title: 'Java 从入门到放弃',\n    author: '张三',\n    available_qty: 5\n  },\n  {\n    id: 2,\n    title: 'Vue3 实战指南',\n    author: '李四',\n    available_qty: 2\n  },\n  {\n    id: 3,\n    title: '数据库系统概论',\n    author: '王五',\n    available_qty: 10\n  }\n]\n\nexport default {\n  created(){\n    const raw = sessionStorage.getItem(\"user\") || localStorage.getItem(\"user\") || \"{}\"\n    this.user = JSON.parse(raw)\n    \n    // 如果 user.id 为 null，尝试从 token 中解析\n    if (!this.user.id) {\n      const token = sessionStorage.getItem(\"token\") || localStorage.getItem(\"token\")\n      if (token) {\n        try {\n          // 解析 JWT token (格式: header.payload.signature)\n          const payload = JSON.parse(atob(token.split('.')[1]))\n          if (payload.id) {\n            this.user.id = payload.id\n            // 更新本地存储\n            const storageKey = sessionStorage.getItem(\"user\") ? \"sessionStorage\" : \"localStorage\"\n            if (storageKey === \"sessionStorage\") {\n              sessionStorage.setItem(\"user\", JSON.stringify(this.user))\n            } else {\n              localStorage.setItem(\"user\", JSON.stringify(this.user))\n            }\n            console.log(\"从 token 中恢复用户 ID:\", payload.id)\n          }\n        } catch (e) {\n          console.error(\"解析 token 失败:\", e)\n        }\n      }\n    }\n    \n    // 确保 role 是数字类型，便于比较\n    if (this.user.role !== undefined && this.user.role !== null) {\n      this.user.role = Number(this.user.role)\n    }\n    console.log(\"User data:\", this.user)\n    console.log(\"User role:\", this.user.role, \"Type:\", typeof this.user.role)\n    this.load()\n  },\n  name: 'BookView',\n  methods: {\n  // (this.isbnArray.indexOf(scope.row.isbn)) == -1\n    handleSelectionChange(val){\n      this.ids = val.map(v =>v.id)\n    },\n    deleteBatch(){\n      if (!this.ids.length) {\n        ElMessage.warning(\"请选择数据！\")\n        return\n      }\n      // 本地模拟批量删除\n      if (this.useMock) {\n        this.ids.forEach(id => {\n          const index = mockBooks.findIndex(b => b.id === id)\n          if (index !== -1) {\n            mockBooks.splice(index, 1)\n          }\n        })\n        ElMessage.success(\"批量删除成功（本地模拟）\")\n        this.load()\n        return\n      }\n      // 真实后端批量删除：逐个调用后端 /delById?id=...\n      Promise.all(\n        this.ids.map(id =>\n          request.get(\"/delById\", { params: { id } })\n        )\n      ).then(() => {\n        ElMessage.success(\"批量删除成功\")\n        this.load()\n      }).catch(() => {\n        ElMessage.error(\"批量删除失败\")\n      })\n    },\n    load(){\n      // 本地模拟查询，不访问后端\n      if (this.useMock) {\n        let list = mockBooks.filter(item => {\n          const matchId = this.search1 ? String(item.id).includes(this.search1) : true\n          const matchTitle = this.search2 ? (item.title || '').includes(this.search2) : true\n          const matchAuthor = this.search3 ? (item.author || '').includes(this.search3) : true\n          return matchId && matchTitle && matchAuthor\n        })\n        this.total = list.length\n        const start = (this.currentPage - 1) * this.pageSize\n        const end = start + this.pageSize\n        this.tableData = list.slice(start, end)\n        return\n      }\n\n      // 构建查询参数\n      const params = {\n        page: this.currentPage,\n        pageSize: this.pageSize,\n      }\n\n      // 根据搜索条件选择接口，若无匹配则默认 /books\n      let url = \"/books\"\n      if (this.search2 && this.search2.trim()) {\n        url = \"/findByTitle\"\n        params.keyword = this.search2.trim()\n      } else if (this.search3 && this.search3.trim()) {\n        url = \"/findByAuthor\"\n        params.author = this.search3.trim()\n      }\n\n      request.get(url, { params }).then(res => {\n        let listData = []\n        const payload = res.data\n\n        if (Array.isArray(payload)) {\n          listData = payload\n        } else if (payload && Array.isArray(payload.records)) {\n          listData = payload.records\n        } else if (payload && Array.isArray(payload.rows)) {\n          listData = payload.rows\n        } else if (payload) {\n          listData = payload\n        }\n\n        if (!Array.isArray(listData)) {\n          listData = []\n        }\n\n        // 规范字段\n        const mapped = listData.map(item => ({\n          id: item.id,\n          title: item.title || item.name || item.bookName || '',\n          author: item.author || '',\n          available_qty: item.available_qty != null ? item.available_qty : (item.borrownum != null ? item.borrownum : 0),\n          borrownum: item.borrownum != null ? item.borrownum : 0,\n          status: (typeof item.status === 'string' ? Number(item.status) : (item.status != null ? item.status : 1)),\n          isbn: item.isbn || '',\n          borrowId: item.borrowId || item.borrow_id || null\n        }))\n        \n        console.log('原始数据示例:', listData[0])\n        console.log('映射后数据示例:', mapped[0])\n\n        // 前端过滤，支持编号/标题/作者组合筛选\n        const filtered = mapped.filter(item => {\n          const matchId = this.search1 ? String(item.id || '').includes(this.search1.trim()) : true\n          const matchTitle = this.search2 ? (item.title || '').includes(this.search2.trim()) : true\n          const matchAuthor = this.search3 ? (item.author || '').includes(this.search3.trim()) : true\n          return matchId && matchTitle && matchAuthor\n        })\n\n        this.tableData = filtered\n        this.total = (payload && payload.total) ? payload.total : filtered.length\n        \n        // 如果是普通用户，加载借阅记录\n        if (this.user.role === 0 && this.user.id) {\n          this.loadBorrowRecords()\n        }\n      }).catch(err => {\n        console.error(\"查询失败:\", err)\n        ElMessage.error(\"查询失败，请稍后重试\")\n        this.tableData = []\n        this.total = 0\n      })\n    },\n    clear(){\n      this.search1 = \"\"\n      this.search2 = \"\"\n      this.search3 = \"\"\n      this.currentPage = 1\n      this.$nextTick(() => {\n        this.load()\n      })\n    },\n    \n    loadBorrowRecords(){\n      // 获取当前用户正在借阅的图书（未归还的）\n      request.get(\"/borrowing/\" + this.user.id).then(res => {\n        const borrowRecords = res.data || []\n        console.log('用户正在借阅的记录:', borrowRecords)\n        \n        // 将借阅记录匹配到图书列表\n        this.tableData = this.tableData.map(book => {\n          // 查找这本书的未还借阅记录（status=0）\n          const borrowRecord = borrowRecords.find(record => \n            (record.bookId === book.id || record.book_id === book.id) && \n            (record.status === 0 || record.status === '0')\n          )\n          \n          if (borrowRecord) {\n            return {\n              ...book,\n              borrowId: borrowRecord.id || borrowRecord.borrowId,\n              hasBorrowed: true\n            }\n          }\n          return book\n        })\n        \n        console.log('匹配后的图书列表:', this.tableData)\n      }).catch(err => {\n        console.error(\"获取借阅记录失败:\", err)\n        // 如果接口返回错误，静默处理\n      })\n    },\n\n    handleDelete(id){\n      // // 本地模拟删除\n      // if (this.useMock) {\n      //   const index = mockBooks.findIndex(b => b.id === id)\n      //   if (index !== -1) {\n      //     mockBooks.splice(index, 1)\n      //     ElMessage.success(\"删除成功（本地模拟）\")\n      //     this.load()\n      //   } else {\n      //     ElMessage.error(\"未找到该图书（本地模拟）\")\n      //   }\n      //   return\n      // }\n\n      // 真实后端删除 /delById?id=...\n      request.get(\"/delById\", { params: { id } }).then(res =>{\n        console.log(res)\n        if(res.code === 1 || res.code === 0 ){\n          ElMessage.success(res.msg || \"删除成功\")\n        }\n        else {\n          ElMessage.error(res.msg || \"删除失败\")\n        }\n        this.load()\n      })\n    },\n    handlereturn(borrowId){\n      if(!borrowId){\n        ElMessage.warning('缺少借阅记录ID')\n        return\n      }\n      \n      console.log('还书参数:', { borrowId: borrowId })\n      \n      // 调用新的后端还书接口\n      request.post(\"/return\", {\n        borrowId: Number(borrowId)\n      }).then(res => {\n        console.log('还书响应:', res)\n        if(res.code === 1 || res.code === 0){\n          ElMessage.success(res.msg || '还书成功')\n          this.$nextTick(() => {\n            this.load()\n          })\n        } else {\n          ElMessage.error(res.msg || '还书失败')\n        }\n      }).catch(err => {\n        console.error(\"还书失败:\", err)\n        const errorMsg = err.response?.data?.msg || err.message || '还书失败，请稍后重试'\n        ElMessage.error(errorMsg)\n      })\n    },\n    handlelend(id){\n      if(this.number ==5){\n        ElMessage.warning(\"您不能再借阅更多的书籍了\")\n        return;\n      }\n      if(this.numOfOutDataBook !=0){\n        ElMessage.warning(\"在您归还逾期书籍前不能再借阅书籍\")\n        return;\n      }\n      \n      // 参数验证\n      if(!this.user.id){\n        ElMessage.error('用户信息异常，请重新登录')\n        return;\n      }\n      if(!id){\n        ElMessage.error('图书信息异常')\n        return;\n      }\n      \n      console.log('借书参数:', { userId: this.user.id, bookId: id })\n      \n      // 调用新的后端借书接口\n      request.post(\"/borrow\", {\n        userId: Number(this.user.id),\n        bookId: Number(id)\n      }).then(res => {\n        console.log('借书响应:', res)\n        if(res.code === 1 || res.code === 0){\n          ElMessage.success(res.msg || '借阅成功')\n          this.$nextTick(() => {\n            this.load()\n          })\n        } else {\n          ElMessage.error(res.msg || '借阅失败')\n        }\n      }).catch(err => {\n        console.error(\"借阅失败:\", err)\n        const errorMsg = err.response?.data?.msg || err.message || '借阅失败，请稍后重试'\n        ElMessage.error(errorMsg)\n      })\n    },\n    add(){\n      this.dialogVisible= true\n      this.form ={\n        available_qty: 0\n      }\n    },\n    save(){\n      // 本地模拟上架 / 修改图书\n      if (this.useMock) {\n        if(this.form.id){\n          const index = mockBooks.findIndex(b => b.id === this.form.id)\n          if (index !== -1) {\n            mockBooks.splice(index, 1, { ...mockBooks[index], ...this.form })\n            ElMessage.success('修改书籍信息成功（本地模拟）')\n          } else {\n            ElMessage.error('未找到该图书（本地模拟）')\n          }\n        }\n        else {\n          const maxId = mockBooks.reduce((max, item) => Math.max(max, item.id), 0)\n          const newItem = {\n            ...this.form,\n            id: maxId + 1,\n          }\n          mockBooks.push(newItem)\n          ElMessage.success('上架书籍成功（本地模拟）')\n        }\n        this.$nextTick(() => {\n          this.load()\n          this.dialogVisible = false\n          this.dialogVisible2 = false\n        })\n        return\n      }\n\n      // 真实后端：根据是否有 id 区分新增/修改\n      if(this.form.id){\n        // 更新可借阅数量\n        request.post(\"/updateBook\",{\n          id: this.form.id,\n          available_qty: this.form.available_qty\n        }).then(res =>{\n          console.log(res)\n          if(res.code === 1 || res.code === 0){\n            ElMessage({\n              message: res.msg || '修改书籍信息成功',\n              type: 'success',\n            })\n          }\n          else {\n            ElMessage.error(res.msg || '修改书籍信息失败')\n          }\n          this.$nextTick(() => {\n            this.load()\n            this.dialogVisible2 = false\n          })\n        })\n      }\n      else {\n        // 新增书籍\n        request.post(\"/addBook\",{\n          title: this.form.title,\n          author: this.form.author,\n          available_qty: this.form.available_qty\n        }).then(res =>{\n          console.log(res)\n          if(res.code === 1 || res.code === 0){\n            ElMessage.success(res.msg || '上架书籍成功')\n          }\n          else {\n            ElMessage.error(res.msg || '上架书籍失败')\n          }\n          this.$nextTick(() => {\n            this.load()\n            this.dialogVisible = false\n          })\n        })\n      }\n\n    },\n    // formatter(row) {:formatter=\"formatter\"\n    //   return row.address\n    // },\n\n    handleEdit(row){\n      this.form = JSON.parse(JSON.stringify(row))\n      this.dialogVisible2 = true\n    },\n    handleSizeChange(pageSize){\n      this.pageSize = pageSize\n      this.load()\n    },\n    handleCurrentChange(pageNum){\n      this.currentPage = pageNum\n      this.$nextTick(() => {\n        this.load()\n      })\n    },\n    toLook(){\n      this.dialogVisible3 =true;\n    },\n  },\n  data() {\n    return {\n      form: {},\n      form2:{},\n      form3:{},\n      dialogVisible: false,\n      dialogVisible2: false,\n      search1:'',\n      search2:'',\n      search3:'',\n      total:10,\n      currentPage:1,\n      pageSize: 5,\n      tableData: [],\n      user:{},\n      number:0,\n      bookData:[],\n      isbnArray:[],\n      outDateBook:[],\n      numOfOutDataBook: 0,\n      dialogVisible3 : true,\n      // 当前是否使用本地模拟图书数据，后端写好后设为 false 即可真实联调\n      useMock: false,\n    }\n  },\n}\n</script>\n","import { render } from \"./BookSearchView.vue?vue&type=template&id=3e4ca9d6\"\nimport script from \"./BookSearchView.vue?vue&type=script&lang=js\"\nexport * from \"./BookSearchView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","style","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_form","inline","size","_component_el_form_item","label","_component_el_input","$data","search1","$event","placeholder","clearable","prefix","_withCtx","_component_el_icon","_component_search","search2","search3","_component_el_button","type","onClick","$options","load","_component_svg_icon","iconClass","clear","_cache","numOfOutDataBook","_createBlock","_component_el_popconfirm","icon","_ctx","InfoFilled","title","onConfirm","toLook","reference","_hoisted_3","user","role","deleteBatch","_component_el_table","data","tableData","stripe","border","onSelectionChange","handleSelectionChange","_component_el_table_column","width","prop","sortable","fixed","scope","handleEdit","row","handleDelete","id","handlelend","disabled","hasBorrowed","handlereturn","borrowId","_component_el_dialog","dialogVisible3","handleClose","footer","_hoisted_4","outDateBook","_hoisted_5","_component_el_pagination","currentPage","pageSize","layout","total","onCurrentChange","handleCurrentChange","dialogVisible","_hoisted_6","save","model","form","author","available_qty","number","min","dialogVisible2","_hoisted_7","mockBooks","created","raw","sessionStorage","getItem","localStorage","this","JSON","parse","token","payload","atob","split","storageKey","setItem","stringify","console","log","e","error","undefined","Number","name","methods","val","ids","map","v","length","useMock","forEach","index","findIndex","b","splice","ElMessage","success","Promise","all","request","get","params","then","catch","warning","list","filter","item","matchId","String","includes","matchTitle","matchAuthor","start","end","slice","page","url","trim","keyword","res","listData","Array","isArray","records","rows","mapped","bookName","borrownum","status","isbn","borrow_id","filtered","loadBorrowRecords","err","$nextTick","borrowRecords","book","borrowRecord","find","record","bookId","book_id","code","msg","post","errorMsg","response","message","userId","add","maxId","reduce","max","Math","newItem","push","handleSizeChange","pageNum","form2","form3","bookData","isbnArray","__exports__","render"],"ignoreList":[],"sourceRoot":""}
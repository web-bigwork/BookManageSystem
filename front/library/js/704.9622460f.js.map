{"version":3,"file":"js/704.9622460f.js","mappings":"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","sources":["webpack://book/./src/views/LoginView.vue","webpack://book/./src/views/LoginView.vue?5755"],"sourcesContent":["<template>\n<div  class=\"login-container\"  >\n    <el-form ref=\"form\" :model=\"form\"   :rules=\"rules\" class=\"login-page\">\n      <h2 class=\"title\" style=\"margin-bottom: 20px\">系统登陆</h2>\n      <el-form-item prop=\"username\" >\n        <el-input v-model=\"form.username\"  clearable>\n          <template #prefix>\n            <el-icon class=\"el-input__icon\"><User /></el-icon>\n          </template>\n        </el-input>\n      </el-form-item>\n      <el-form-item prop=\"password\">\n        <el-input v-model=\"form.password\"  clearable show-password>\n          <template #prefix>\n            <el-icon class=\"el-input__icon\"><Lock /></el-icon>\n          </template>\n        </el-input>\n      </el-form-item>\n      <el-form-item>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\"  style=\" width: 100%\" @click=\"login\">登 录</el-button>\n      </el-form-item>\n      <el-form-item><el-button type=\"text\" @click=\"$router.push('/register')\">前往注册 >> </el-button></el-form-item>\n    </el-form>\n</div>\n\n</template>\n\n<script>\nimport request from \"../utils/request\";\nimport {ElMessage} from \"element-plus\";\n\n// (mock users removed — using real backend)\n\nexport default {\n  name: \"LoginView\",\n  components:{},\n  data() {\n    return {\n      form: {},\n      // 当前是否使用本地模拟登录，后端写好后改成 false 即可\n      useMock: false,\n      rules: {\n        username: [\n          {\n            required: true,\n            message: '请输入用户名',\n            trigger: 'blur',\n          }\n        ],\n        password: [\n          {\n            required: true,\n            message: '请输入密码',\n            trigger: 'blur',\n          }\n        ]\n\n      }\n\n    }\n  },\n  methods: {\n    login(){\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          // // 本地模拟登录，不访问后端\n          // if (this.useMock) {\n          //   const user = mockLoginUsers.find(\n          //     u => u.username === this.form.username && u.password === this.form.password\n          //   )\n          //   if (!user) {\n          //     ElMessage.error(\"用户名或密码错误（本地模拟）\")\n          //     return\n          //   }\n          //   // 模拟后端返回的用户信息\n          //   const userInfo = {\n          //     id: user.id,\n          //     username: user.username,\n          //     role: user.role\n          //   }\n          //   sessionStorage.setItem(\"user\", JSON.stringify(userInfo))\n          //   ElMessage.success(\"登录成功（本地模拟）\")\n          //   this.$router.push(\"/dashboard\")\n          //   return\n          // }\n\n          // 真实后端请求（接好后端再使用）\n          request.post(\"/login\", this.form).then(res => {\n            // 后端 Result.success: code=1, data={token,userRole,...}\n            if (res.code === 1 || res.code === 0) {\n              const resp = res.data || {}\n              // 兜底从多处取 token\n              const token = resp.token || resp.jwt_token || res.token || res.jwt_token || (typeof resp === 'string' ? resp : null)\n              if (!token) {\n                console.warn('No token found in response:', resp)\n                ElMessage.error('登录失败：未收到 token，后端可能未正确返回')\n                return\n              }\n              // 持久化 token 到 sessionStorage + localStorage，便于刷新后依然可用\n              try {\n                sessionStorage.setItem('token', token)\n                sessionStorage.setItem('jwt_token', token)\n                localStorage.setItem('token', token)\n                localStorage.setItem('jwt_token', token)\n              } catch (e) {\n                console.error('Error storing token:', e)\n              }\n              // 组装用户信息\n              const role = resp.userRole != null ? Number(resp.userRole) : (resp.roleName === 'admin' ? 1 : (resp.role || 0))\n              const userObj = {\n                id: resp.id || resp.userId || null,\n                username: resp.username || this.form.username,\n                role\n              }\n              sessionStorage.setItem(\"user\", JSON.stringify(userObj))\n              localStorage.setItem(\"user\", JSON.stringify(userObj))\n              if (userObj.username) {\n                sessionStorage.setItem(\"username\", userObj.username)\n                localStorage.setItem(\"username\", userObj.username)\n              }\n              ElMessage.success(res.msg || \"登录成功\")\n              this.$router.push(\"/dashboard\")\n            } else {\n              ElMessage.error(res.msg || \"登录失败\")\n            }\n          }).catch(err => {\n            console.error('login error', err)\n            ElMessage.error('登录请求失败')\n          })\n        }\n      })\n\n    }\n  }\n}\n\n</script>\n\n<style scoped>\n.login-container {\n  position: fixed;\n  width: 100%;\n  height: 100vh;\n  background: url('../img/bg2.svg');\n  background-size: contain;\n  overflow: hidden;\n}\n.login-page {\n  border-radius: 5px;\n  margin: 180px auto;\n  width: 350px;\n  padding: 35px 35px 15px;\n  background: #fff;\n  border: 1px solid #eaeaea;\n  box-shadow: 0 0 25px #cac6c6;\n}\n</style>","import { render } from \"./LoginView.vue?vue&type=template&id=358d77a9&scoped=true\"\nimport script from \"./LoginView.vue?vue&type=script&lang=js\"\nexport * from \"./LoginView.vue?vue&type=script&lang=js\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=358d77a9&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-358d77a9\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_form","ref","model","$data","form","rules","_createElementVNode","style","_component_el_form_item","prop","_component_el_input","username","$event","clearable","prefix","_withCtx","_component_el_icon","_component_User","password","_component_Lock","_component_el_button","type","onClick","$options","login","_cache","_ctx","$router","push","name","components","data","useMock","required","message","trigger","methods","this","$refs","validate","valid","request","post","then","res","code","resp","token","jwt_token","console","warn","ElMessage","error","sessionStorage","setItem","localStorage","e","role","userRole","Number","roleName","userObj","id","userId","JSON","stringify","success","msg","catch","err","__exports__","render"],"ignoreList":[],"sourceRoot":""}